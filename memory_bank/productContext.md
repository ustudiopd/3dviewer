# 비즈니스 로직 및 기능 동작 (Product Context)

## 1. 핵심 비즈니스 로직  
- **데모 접근 코드 생성**: 
  - 8자리 영숫자 랜덤 코드 자동 생성
  - 고유성 보장 (데이터베이스 제약 조건)
- **접속 로그 수집**: 
  - 데모 페이지 접근 시 자동으로 로그 수집
  - 사용자 에이전트 정보 저장
  - 데모 ID와 접근 코드 매핑
- **모델 파일 관리**: 
  - Supabase Storage에 GLB/GLTF 파일 저장
  - 파일 메타데이터는 PostgreSQL에 저장
  - Draco 압축 및 KTX2 텍스처 옵션 지원

## 2. 주요 기능별 동작 시나리오  

### **기능 1: 3D 모델 뷰어**
1. 사용자가 데모 접근 코드로 페이지 접근 (`/[code]`)
2. 서버에서 접근 코드로 데모 정보 조회
3. 데모에 연결된 모델 파일 URL 가져오기
4. `DynamicModelViewer` 컴포넌트가 모델 로드
5. `@google/model-viewer`가 3D 모델 렌더링
6. 사용자가 마우스/터치로 모델 조작:
   - 드래그: 모델 회전
   - 휠: 확대/축소
   - 우클릭 + 드래그: 카메라 이동
7. 접속 로그 자동 수집 (API 호출)

**UI 요소**:
- 상단 왼쪽: 모델명 버튼 (클릭 시 조작 방법 툴팁 토글), 홈 버튼
- 중앙: 3D 모델 뷰어
- 로딩 중: 진행률 표시

### **기능 2: 관리자 로그인**
1. 관리자가 `/admin/login` 접근
2. 비밀번호 입력
3. 서버에서 환경 변수의 `ADMIN_PASSWORD`와 비교
4. 일치하면 세션 생성 및 `/admin/dashboard`로 리다이렉트
5. 세션 쿠키로 인증 상태 유지

### **기능 3: 모델 업로드**
1. 관리자가 대시보드에서 "모델 업로드" 클릭
2. `FileUploadModal` 열림
3. 파일 선택 (GLB/GLTF)
4. 파일명 입력 (선택사항)
5. Draco 압축 및 KTX2 옵션 선택
6. 업로드 시작:
   - 파일을 Supabase Storage에 업로드
   - 파일 메타데이터를 `models` 테이블에 저장
7. 업로드 완료 후 모델 목록 자동 갱신

### **기능 4: 데모 생성**
1. 관리자가 대시보드에서 "데모 생성" 클릭
2. `CreateDemoModal` 열림
3. 모델 선택 (드롭다운)
4. 메모 입력 (선택사항)
5. 생성 버튼 클릭:
   - 8자리 접근 코드 자동 생성
   - `demos` 테이블에 레코드 생성
   - 모델 ID와 접근 코드 연결
6. 생성된 데모가 목록에 표시
7. "링크 복사" 또는 "새창 열기" 버튼으로 공유

### **기능 5: 접속 로그 조회**
1. 관리자가 데모 목록에서 "접속 로그" 클릭
2. 해당 데모의 접속 기록 조회
3. 모달에서 접속 시간, 사용자 에이전트 정보 표시
4. 통계 정보 (총 접속 수) 표시

### **기능 6: 모델/데모 관리**
- **모델 이름 수정**: 모델 목록에서 이름 클릭 → 수정 모드 → 저장
- **데모 메모 수정**: "메모 수정" 버튼 → 모달에서 수정 → 저장
- **데모 삭제**: "삭제" 버튼 → 확인 다이얼로그 → 삭제 실행
- **모델 삭제**: (주의: 연결된 데모가 있으면 삭제 불가)

## 3. 데이터 모델
- **models 테이블**: 
  - id, name, file_path, file_size, is_draco, is_ktx2, created_at
- **demos 테이블**: 
  - id, model_id, access_code, memo, created_at
- **access_logs 테이블**: 
  - id, demo_id, access_code, user_agent, accessed_at

## 4. 사용자 경험 (UX)
- **3D 뷰어**: 
  - Babylon.js Sandbox 스타일 그라데이션 배경 (`linear-gradient(135deg, #a8abb0 0%, #3a3d40 100%)`)
  - HDR 환경 맵을 통한 고품질 조명 및 반사 효과
  - 부드러운 로딩 애니메이션 및 진행률 표시
  - 컴팩트한 UI (헤더 버튼, 툴팁)
- **관리자 대시보드**: 
  - 통계 카드 (총 모델 수, 활성 데모 수, 총 접속 수)
  - 테이블 형태의 모델/데모 목록
  - 모달을 통한 상세 작업 (업로드, 생성, 수정)
  - 반응형 디자인 (모바일 지원)
